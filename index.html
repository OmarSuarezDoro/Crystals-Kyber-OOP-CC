<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Crystals-Kyber C++ Implementation: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Crystals-Kyber C++ Implementation
   &#160;<span id="projectnumber">v0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Crystals-Kyber C++ Implementation Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__home_noex_projects_Crystal_Kyber_C__README"></a> Authors:</p><ul>
<li><b>Omar Suárez Doro</b> (<a href="#" onclick="location.href='mai'+'lto:'+'alu'+'01'+'014'+'83'+'474'+'@u'+'ll.'+'ed'+'u.e'+'s'; return false;">alu01<span style="display: none;">.nosp@m.</span>0148<span style="display: none;">.nosp@m.</span>3474@<span style="display: none;">.nosp@m.</span>ull.<span style="display: none;">.nosp@m.</span>edu.e<span style="display: none;">.nosp@m.</span>s</a>)</li>
<li><b>Edgar Pérez Ramos</b> (<a href="#" onclick="location.href='mai'+'lto:'+'alu'+'01'+'012'+'07'+'667'+'@u'+'ll.'+'ed'+'u.e'+'s'; return false;">alu01<span style="display: none;">.nosp@m.</span>0120<span style="display: none;">.nosp@m.</span>7667@<span style="display: none;">.nosp@m.</span>ull.<span style="display: none;">.nosp@m.</span>edu.e<span style="display: none;">.nosp@m.</span>s</a>)</li>
<li><b>Pino Caballero Gil</b> (<a href="#" onclick="location.href='mai'+'lto:'+'pca'+'ba'+'lle'+'@u'+'ll.'+'ed'+'u.e'+'s'; return false;">pcaba<span style="display: none;">.nosp@m.</span>lle@<span style="display: none;">.nosp@m.</span>ull.e<span style="display: none;">.nosp@m.</span>du.e<span style="display: none;">.nosp@m.</span>s</a>) </li>
</ul>
<h2><a class="anchor" id="autotoc_md0"></a>
1. Index</h2>
<ul>
<li><a href="#1-index">1. Index</a></li>
<li><a href="#2-abstract">2. Abstract</a></li>
<li><a href="#3-why-c">3. Why C++?</a></li>
<li><a href="#4-main-concepts">4. Main Concepts</a><ul>
<li><a href="#a-lattices">a) Lattices</a></li>
<li><a href="#b-learning-with-errors-problem">b) Learning With Errors Problem</a></li>
</ul>
</li>
<li><a href="#5-components">5. Components</a><ul>
<li><a href="#a-data-structures">a) Data Structures</a></li>
<li><a href="#b-keccak">b) Keccak</a></li>
<li><a href="#c-ntt-number-theoretic-transform">c)</a></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md1"></a>
2. Abstract</h2>
<p>This repository contains a C++ implementation of <b>Crystals Kyber Algorithm</b>(CKA). The CKA is a standard in <b>Post Quantum Cryptography</b>(PQC), which development is driven by National Institute of Standards and Technology (<a href="https://www.nist.gov/">NIST</a>).</p>
<h2><a class="anchor" id="autotoc_md2"></a>
3. Why C++?</h2>
<p>The main purpouse of this repository is to document the CKA in a <b>didactic way</b>. Despite the fact that C++ is a language which learning curve is really steep, it provides a lot of features that may help by the time you are learning how Kyber works. One of this features is the <b>Object Oriented Programming</b>(POO), that allow us to understand kyber as some pieces or components that work together to bring us Well Developed cryptographyc scheme.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
4. Main Concepts</h2>
<p>The first thing we need to do, in order to understand Kyber is learning about <b>Mathematical fundamentals</b> that Kyber is based (don't be afraid, I am bad at Maths too). In cryptography, we need problems that are easy to solve for the device we are communication with, and hard for others, for example, attackers that are sniffing the traffic over the network where messages are being sent. Crystals Kyber Algorithm uses mathematical structures known as <b>lattices</b>, and the problem that we are going to use is the Learning With Errors Problem</p>
<h3><a class="anchor" id="autotoc_md4"></a>
a) Lattices</h3>
<p>A lattice is a mathematical structure which is created using lineal combinations <b>vectorial base</b>. This means that having two vectors $\vec{a}$ and $\vec{u}$ and making some lineal combinations like ($2 \cdot \vec{a} + 1 \cdot \vec{u}$) or ($2 \cdot \vec{u}$) we can generate a lattice. Here is a visual way:</p>
<div align="center"> <img src="https://www.redhat.com/rhdc/managed-files/styles/wysiwyg_full_width/private/lattice-based-cryptography.png?itok=IQVzd4YD" alt="" height="200px" class="inline"/> </div><p> <br  />
</p>
<blockquote class="doxtable">
<p>[!note] It is important to keep in mind that <b>different vectors</b> can generate the <b>same</b> lattice </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md5"></a>
b) Learning With Errors Problem</h3>
<p>Suppose that somehow we can represent messages in the points of the lattice that we are going to use and we have a <em>equations system</em> that we need to solve, in order to get the key, and therefore, decypher the encrypted message. The solution of this system is the exact lineal combination to get the point that represent the message. This sounds weird, because seems like bruteforce mixed with Gauss Method, substitution could break this scheme. <br  />
</p>
<div align="center"> <img src="https://latex.codecogs.com/svg.image?\inline&space;\LARGE&space;\bg{white}{\color{White}\begin{eqnarray}2x&plus;y=1\\x&plus;y=4\\x&plus;y&plus;z=6\end{eqnarray}}" alt="" title="{\color{White}\begin{eqnarray}2x+y=1\\x+y=4\\x+y+z=6\end{eqnarray}}" class="inline"/> </div><p><br  />
</p>
<p>The answer is <b>YES</b>. That is the reason that we are going to introduce a little "noise" or "error" in the system:</p>
<p><br  />
</p>
<div align="center"> <img src="https://latex.codecogs.com/svg.image?\inline&space;\LARGE&space;\bg{white}{\color{White}\begin{eqnarray}2x&plus;y=1-{\color{red}1}\\x&plus;y=4-{\color{red}3}\\x&plus;y&plus;z=6-{\color{red}2}\end{eqnarray}}" alt="" title="{\color{White}\begin{eqnarray}2x+y=1-{\color{red}1}\\x+y=4-{\color{red}3}\\x+y+z=6-{\color{red}2}\end{eqnarray}}" class="inline"/> </div><p><br  />
</p>
<p>Now</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Concept   </th><th class="markdownTableHeadNone">Short Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Lattice   </td><td class="markdownTableBodyNone">A lattice is a mathematic structure, which is built by lineal combinations of a n -vectors, where n define the dimention of the lattice.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LWE problem   </td><td class="markdownTableBodyNone">The <b>learning with errors</b> problem consist in, having a vectorial base and a point (P) in the plane. Discover which lineal combination of the vectors should we use, in order to be in the closest point to P.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Big O notation (<b>O(n)</b>)   </td><td class="markdownTableBodyNone">Is a standard which function describe the time that an algorithm needs to be completed. This notation focussed in the <b>worst case</b> with a sample of n elements.   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md6"></a>
5. Components</h2>
<h3><a class="anchor" id="autotoc_md7"></a>
a) Data Structures</h3>
<p>Our implementation of CKA is based in two <b>primitive</b> structures, which hold the main data.</p>
<ol type="1">
<li><b><a class="el" href="classPolynomial.html" title="This file contains the header declaration and implementation of the class Polynomial.">Polynomial</a></b>: This class represents a polynomial and provide us with some useful functionalities such as the <em>addition</em>, <em>print_operation</em>, etc.. It is mapped using a <b>vector structure</b> of T, where T is a template parameter.</li>
</ol>
<p>Example of use: </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line">Polynomial&lt;int&gt; poly1_ = Polynomial&lt;int&gt;(3);</div>
<div class="line">Polynomial&lt;int&gt; poly2_ = Polynomial&lt;int&gt;(3);</div>
<div class="line">    poly1_[0] = 1;</div>
<div class="line">    poly1_[1] = 2;</div>
<div class="line">    poly1_[2] = 3;</div>
<div class="line">    poly2_[0] = 4;</div>
<div class="line">    poly2_[1] = 5;</div>
<div class="line">    poly2_[2] = 6;</div>
<div class="line">Polynomial&lt;int&gt; result = poly1_ + poly2_;</div>
</div><!-- fragment --><ol type="1">
<li><b><a class="el" href="classMatrix.html">Matrix</a></b>: This class represents a matrix of T type, which T is the template parameter, as the previous one. This class follows a desing pattern called <b>Facade</b> in order to make easy to work with a 3 dimensional vectors structure.</li>
</ol>
<p>Example of use: </p><div class="fragment"><div class="line"> {c++}</div>
<div class="line">Matrix&lt;Polynomial&lt;int&gt;&gt; mat4_ = Matrix&lt;Polynomial&lt;int&gt;&gt;(2, 2, 3);</div>
<div class="line">Matrix&lt;Polynomial&lt;int&gt;&gt; mat5_ = Matrix&lt;Polynomial&lt;int&gt;&gt;(2, 2, 3);</div>
<div class="line">    Polynomial&lt;int&gt; p1 = Polynomial&lt;int&gt;(3);</div>
<div class="line">    p1[0] = 3;</div>
<div class="line">    p1[1] = 2;</div>
<div class="line">    p1[2] = 1;</div>
<div class="line">    Polynomial&lt;int&gt; p2 = Polynomial&lt;int&gt;(3);</div>
<div class="line">    p2[0] = 4;</div>
<div class="line">    p2[1] = 3;</div>
<div class="line">    p2[2] = 2;</div>
<div class="line">    mat4_(0, 0) = p1;</div>
<div class="line">    mat4_(0, 1) = p2;</div>
<div class="line">    mat5_(0, 0) = p1;</div>
<div class="line">Matrix&lt;Polynomial&lt;int&gt;&gt; result = mat4_ + mat5_;</div>
</div><!-- fragment --><ol type="1">
<li><b><a class="el" href="classBytes.html" title="This file contains the header declaration of the class Bytes.">Bytes</a></b>: This class implements a set of bytes. They are mapped as <code>std::vector&lt;unsigned char&gt;</code> object, this is because we have the entire <b>8 bits</b> range representation. If we have used normal char 1 bit is used for sign representation, this is not a real problem in representation operations, but it is <b>highly</b> important in arithmethic operations. If we want to operate in a signed way, we can use the signed version of methods. The main reason of using our own <b>Byte Structure</b> is to follow facade patterns, in order to simplify the management of some custom <b>data structures</b> that libraries like <a href="https://github.com/weidai11/cryptopp">Cryptopp</a> use.</li>
</ol>
<p>The bytes structure work with each bytes as <b>Little Endian</b> way, that means that the left Byte is the less significant. However, bits are interpreted from right to left (the common way to read binary).</p>
<p>The bytes structure allow us to make operations with <a class="el" href="classBytes.html" title="This file contains the header declaration of the class Bytes.">Bytes</a> in a simple way. Hereis a list of some methods that are included in this class:</p><ul>
<li>operator+ : which make the concatenation</li>
<li>bitwise operations like and (&amp;), or (|), not(~)..</li>
<li>operator&lt;&lt; and operator&gt;&gt; : which will make a shift in any char that the string has. <b>CAREFUL!</b> It doesn't take care of carrying bits, it will make shift operation in any byte, and the bits that are overflowed will dissapear. <b>TAKE CARE OF THIS</b>.</li>
<li>A few methods of transformation:<ul>
<li>FromBytesToBits: Return a string of the bit representation of each byte.</li>
<li>FromBytesToHex: Return a string of hex representation of each byte.</li>
<li>FromBytesToNumbers: Return a long with the value of the bytes, It iterates, adding each bit * 2^n to the result.</li>
<li>GetBytesAsNumbersVector: Return an int vector that contains each separated int value of the bytes.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
b) Keccak</h3>
<p>The <a class="el" href="classKeccak.html" title="This file contains the header declaration of the class Keccak, which give us some cryptographic funct...">Keccak</a> component consists in a set of <b>Cryptographic functions</b> which are provided by the <a href="https://github.com/weidai11/cryptopp">Cryptopp</a> library, also known as Crypto++. <a class="el" href="classKeccak.html" title="This file contains the header declaration of the class Keccak, which give us some cryptographic funct...">Keccak</a> is structured by static methods (this is because, in our opinion, it is easy to understand the kyber as boxes that implements a set of functions that we will need), that we will call **"Logic Gates"**.</p>
<p>This Logic Gates operates with privates methods which use the functions of the library Crytopp and return our custom byte structure. This logic gates are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Gate   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Extendable-output function (<b>XOF</b>)   </td><td class="markdownTableBodyNone">Is an extension of the cryptographic hash that allows its output to be arbitrarily long.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Pseudorandom function family(<b>PRF</b>)   </td><td class="markdownTableBodyNone">Is a collection of efficiently-computable functions which emulate a random oracle in the following way: no efficient algorithm can distinguish (with significant advantage) between a function chosen randomly from the PRF family and a random oracle (a function whose outputs are fixed completely at random).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Key derivation function (<b>KDF</b>)   </td><td class="markdownTableBodyNone">Is a cryptographic algorithm that derives one or more secret keys from a secret value such as a master key, a password, or a passphrase using a pseudorandom function    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">(<b>H</b>)   </td><td class="markdownTableBodyNone">Hash function used to derive cryptographic material (seed for public matrix A, coins, shared keys) from arbitrary-length byte strings. Output is a 32-byte string.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(<b>G</b>)   </td><td class="markdownTableBodyNone">Hash function used to generate noise polynomials for the secret key. Output is a concatenation of two 32-byte strings.   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md9"></a>
c) NTT (Number Theoretic Transform)</h3>
<p>The <a class="el" href="classNTT.html" title="This file contains the header declaration of the class NTT, which give us The Number Theorical Transf...">NTT</a> is a variant of the Discrete Fourier Transform (DFT), but it operates in a finite field instead of complex numbers. This allows for efficient computations with integers, which is crucial for cryptographic applications.</p>
<p>The primary reason for using <a class="el" href="classNTT.html" title="This file contains the header declaration of the class NTT, which give us The Number Theorical Transf...">NTT</a> in cryptographic schemes like Kyber is to <b>efficiently perform polynomial multiplication</b>. <br  />
</p>
<blockquote class="doxtable">
<p>[!NOTE]</p>
<p>&gt;The computational complexity is highly decreased due to this algorithm: </p><div align="center"> <img src="https://latex.codecogs.com/svg.image?\inline&space;\LARGE&space;\bg{white}{\color{White}O(n^2)\rightarrow&space;O(n\cdot&space;log(n))}" alt="" title="{\color{White}O(n^2)\rightarrow O(n\cdot log(n))}" class="inline"/> </div><p> &gt;This happens because the following domain transformation is performed: </p><div align="center"> <img src="https://latex.codecogs.com/svg.image?\inline&space;\LARGE&space;\bg{white}{\color{White}R_q^{k\cdot&space;k}\rightarrow&space;R_q^k}" alt="" title="{\color{White}R_q^{k\cdot k}\rightarrow R_q^k}" class="inline"/> </div><p> Where <b>q</b> is the prime that we are using in the algorithm and <b>k</b> the dimension. </p><div align="center"> <img src="https://latex.codecogs.com/svg.image?\inline&space;\LARGE&space;\bg{white}{\color{White}\begin{pmatrix}\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}&amp;\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}\\\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}&amp;\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}\end{pmatrix}_{R{^{k\cdot&space;k}_q}}\\\longrightarrow\begin{pmatrix}\begin{bmatrix}165\end{bmatrix}\\\begin{bmatrix}125\end{bmatrix}\\\end{pmatrix}_{R_q^k}}" alt="" title="{\color{White}\begin{pmatrix}\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}&amp;\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}\\\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}&amp;\begin{bmatrix}1&amp;2&amp;3\end{bmatrix}\end{pmatrix}_{R{^{k\cdot&amp;space;k}_q}}\\\longrightarrow\begin{pmatrix}\begin{bmatrix}165\end{bmatrix}\\\begin{bmatrix}125\end{bmatrix}\\\end{pmatrix}_{R_q^k}}" class="inline"/> </div> </blockquote>
<p>The <a class="el" href="classNTT.html" title="This file contains the header declaration of the class NTT, which give us The Number Theorical Transf...">NTT</a> class allow us to apply <a class="el" href="classNTT.html" title="This file contains the header declaration of the class NTT, which give us The Number Theorical Transf...">NTT</a> transformations to our polynomials. The main method that we need to use is the <b>NTT_kyber</b> which second parameter determinate if we are going to use <b>inverse <a class="el" href="classNTT.html" title="This file contains the header declaration of the class NTT, which give us The Number Theorical Transf...">NTT</a></b> or the <b>average one</b>.</p>
<p>An example of use is: </p><div class="fragment"><div class="line"> {C++}</div>
<div class="line">Polynomial&lt;int&gt; result = ntt.NTT_Kyber([10,...,30], true);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10"></a>
d)</h3>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
