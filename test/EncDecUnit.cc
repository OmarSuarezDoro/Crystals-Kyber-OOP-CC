/**
 * Universidad de La Laguna
 * Escuela Superior de Ingeniería y Tecnología
 * Grado en Ingeniería Informática
 * Trabajo de Fin de Grado - Kleptographic Attacks on Lattice-Based CryptoSystems
 *
 * @author Omar Suárez Doro
 * @date August 14 2024
 * @version v0.1.0
 * @brief This file contains the tests for the EncDecUnit class
 */

#include <gtest/gtest.h>
#include "../src/Components/EncDecUnit.h"
#include "../src/DataStructures/Bytes.h"

class EncDecUnitTest : public ::testing::Test {
 public:
  Polynomial<int> test_polynomial1 = Polynomial<int>(256);
  Polynomial<int> test_polynomial2 = Polynomial<int>(256);
  Bytes test_bytes1;
  Bytes test_bytes2;
  Matrix<Polynomial<int>> test_matrix1 = Matrix<Polynomial<int>>(2, 1, 256);

 protected:
  virtual void SetUp() {
    // Set up the test cases
    test_polynomial1.SetCoefficients({2625, 2266, 3256, 2071, 1525, 18, 262, 2227, 3053, 2349, 1584, 3328, 2711, 2902, 2032,
     1896, 179, 1105, 384, 3211, 217, 2904, 1454, 1538, 962, 641, 49, 2494, 2847, 514, 3313, 1902, 1636, 751, 2398, 1715, 
     2864, 1303, 1630, 2890, 1226, 1087, 1221, 1236, 2047, 912, 2140, 1041, 495, 441, 2328, 3243, 2530, 3174, 1371, 96, 
     2701, 178, 3179, 1429, 263, 1621, 802, 777, 1687, 740, 724, 702, 687, 1692, 3106, 169, 790, 1613, 666, 1012, 3195, 
     614, 2402, 1972, 656, 2781, 1354, 982, 430, 2193, 1917, 682, 542, 407, 877, 2656, 1259, 3123, 1140, 1001, 2192, 3066, 
     3209, 3268, 2003, 970, 1215, 2613, 258, 2854, 723, 675, 1921, 2610, 769, 1235, 2577, 961, 731, 136, 12, 910, 1767, 737, 
     648, 530, 3126, 2790, 2899, 283, 1008, 535, 525, 2170, 3111, 811, 1458, 514, 776, 831, 28, 2274, 772, 2511, 871, 2420, 
     2862, 3218, 1771, 1420, 2932, 15, 2752, 289, 3026, 2472, 1632, 2539, 1605, 950, 504, 3117, 2497, 2758, 1152, 611, 2837, 
     813, 1836, 2066, 2902, 2707, 88, 167, 2390, 733, 2602, 3129, 1342, 2909, 1090, 1929, 1011, 1929, 2976, 1053, 2106, 1846, 
     1934, 2731, 234, 2771, 1376, 170, 523, 3008, 2323, 2672, 1258, 412, 156, 2222, 686, 1562, 487, 591, 98, 2886, 1685, 2005, 
     981, 1085, 2, 2500, 2531, 610, 1384, 2478, 2561, 1912, 3147, 1893, 363, 3285, 2561, 2361, 1484, 2596, 635, 158, 2918, 1771, 
     3024, 2650, 2517, 2065, 533, 1760, 476, 2911, 1049, 1074, 849, 272, 248, 204, 3313, 2010, 513, 1939, 1659, 2234, 1038, 251, 
     3053, 1045, 2350, 2892, 1035, 130});
    test_bytes1 = Bytes(std::vector<int>{60, 149, 134, 17, 170, 203, 63, 167, 35, 56, 49, 0, 177, 114, 59, 133, 50, 13, 129, 218, 7, 103, 140, 9, 234,
     124, 9, 32, 0, 80, 176, 198, 106, 181, 166, 91, 204, 182, 53, 236, 197, 73, 116, 129, 179, 72, 160, 178, 72, 249, 118, 41, 231, 107, 167, 233, 112,
     11, 133, 204, 163, 179, 189, 157, 97, 136, 17, 217, 29, 106, 122, 69, 55, 240, 158, 125, 179, 72, 103, 19, 60, 207, 58, 18, 246, 106, 75, 169, 235, 
     6, 47, 140, 145, 227, 194, 74, 17, 145, 42, 215, 247, 93, 202, 18, 20, 20, 166, 96, 242, 162, 111, 218, 181, 46, 238, 101, 162, 162, 216, 27, 119, 
     154, 11, 144, 55, 127, 185, 108, 27, 169, 198, 113, 85, 249, 60, 43, 92, 206, 147, 249, 1, 191, 200, 167, 143, 234, 142, 133, 199, 50, 230, 146, 
     16, 66, 187, 108, 26, 123, 200, 1, 22, 68, 17, 85, 44, 73, 89, 89, 199, 163, 98, 131, 217, 103, 62, 193, 59, 243, 67, 124, 38, 22, 157, 36, 144, 
     128, 218, 249, 130, 124, 8, 145, 235, 188, 95, 192, 182, 192, 244, 72, 118, 13, 228, 61, 92, 188, 80, 39, 17, 83, 141, 10, 141, 143, 91, 129, 32, 
     155, 124, 54, 181, 94, 24, 92, 123, 65, 38, 61, 56, 42, 150, 185, 97, 21, 212, 36, 82, 60, 241, 169, 199, 152, 9, 85, 82, 8, 242, 38, 185, 141, 
     104, 63, 4, 225, 86, 70, 118, 92, 60, 220, 140, 224, 108, 184, 156, 225, 129, 21, 72, 162, 160, 230, 142, 20, 203, 15, 27, 184, 128, 58, 249, 136, 
     130, 52, 198, 205, 92, 46, 71, 82, 181, 43, 176, 177, 18, 216, 140, 90, 123, 163, 55, 247, 98, 103, 197, 20, 129, 228, 174, 201, 50, 130, 52, 96, 
     189, 215, 196, 129, 247, 136, 8, 250, 69, 97, 166, 92, 140, 129, 84, 108, 55, 120, 160, 127, 176, 81, 237, 180, 85, 112, 1, 51, 143, 176, 39, 18, 
     247, 159, 26, 20, 79, 74, 167, 9, 233, 181, 114, 198, 183, 116, 242, 23, 36, 145, 167, 28, 140, 138, 24, 183, 113, 192, 72, 165, 31, 183, 50, 164, 
     89, 72, 12, 17, 58, 124});

    test_bytes2 = Bytes(std::vector<int>{181, 183, 19, 49, 136, 74, 245, 186, 130, 250, 249, 145, 220, 245, 56, 39, 252, 184, 127, 246, 194, 188, 155, 40, 137, 170, 26, 210,
    88, 155, 40, 229, 82, 230, 20, 183, 95, 42, 174, 162, 148, 66, 16, 150, 38, 32, 53, 63, 136, 53, 61, 254, 242, 79, 209, 112, 179, 78, 7, 43, 99, 150, 192, 147, 234,
    107, 248, 250, 82, 102, 246, 114, 27, 12, 176, 200, 25, 126, 61, 119, 197, 141, 28, 205, 13, 85, 45, 97, 160, 129, 108, 43, 103, 113, 4, 31, 37, 66, 167, 172, 227,
    6, 211, 96, 51, 254, 153, 188, 24, 68, 171, 195, 40, 185, 96, 183, 122, 178, 120, 81, 171, 203, 154, 191, 50, 162, 248, 114, 55, 229, 108, 28, 40, 171, 106, 148, 27,
    90, 233, 183, 80, 215, 40, 126, 138, 123, 116, 189, 170, 149, 179, 124, 61, 108, 149, 161, 79, 6, 11, 24, 168, 183, 157, 12, 95, 25, 19, 35, 11, 102, 120, 13, 89, 134,
    168, 252, 33, 109, 124, 152, 59, 138, 31, 116, 6, 40, 30, 229, 70, 119, 117, 106, 140, 227, 101, 223, 65, 124, 75, 251, 207, 13, 117, 199, 212, 0, 78, 228, 72, 113, 66,
    236, 198, 82, 67, 71, 128, 97, 207, 69, 246, 128, 254, 202, 89, 27, 169, 176, 15, 226, 14, 181, 241, 113, 22, 168, 39, 60, 101, 179, 100, 136, 47, 102, 112, 11, 62, 168,
    47, 180, 59, 188, 2, 98, 55, 29, 70, 62, 161, 161, 120, 147, 233, 113, 189, 144, 125, 174, 243, 32, 3, 89, 180, 164, 6, 124, 79, 10, 77, 105, 236, 193, 236, 18, 169, 114,
    246, 141, 106, 40, 164, 225, 137, 70, 47, 43, 191, 218, 140, 83, 125, 26, 152, 93, 186, 13, 79, 7, 178, 153, 160, 28, 40, 60, 6, 237, 185, 63, 91, 243, 68, 208, 86, 156,
    98, 25, 52, 183, 21, 111, 85, 55, 21, 134, 137, 42, 191, 92, 6, 31, 58, 127, 205, 250, 96, 159, 81, 197, 232, 196, 47, 197, 195, 107, 156, 150, 133, 103, 135, 124, 234, 49,
    126, 100, 196, 57, 141, 115, 197, 10, 43, 118, 209, 51, 186, 143, 69, 92, 205, 28, 42, 254, 84, 119, 155, 53, 182, 98, 89, 145, 73, 12, 78, 119, 41, 32, 157, 117, 90, 41, 171,
    102, 123, 193, 106, 19, 28, 68, 32, 128, 116, 28, 139, 50, 122, 23, 105, 124, 193, 14, 103, 97, 178, 147, 40, 83, 200, 197, 85, 245, 231, 192, 208, 232, 5, 104, 188, 8, 46, 178,
    47, 121, 34, 74, 225, 37, 200, 1, 204, 171, 19, 180, 151, 121, 101, 9, 253, 81, 168, 232, 138, 39, 41, 54, 163, 2, 155, 104, 185, 70, 66, 47, 87, 33, 99, 179, 106, 149, 39, 195,
    94, 66, 91, 61, 212, 68, 86, 182, 36, 66, 38, 205, 178, 181, 37, 153, 220, 132, 6, 213, 116, 35, 108, 159, 47, 7, 102, 89, 130, 172, 210, 243, 163, 66, 26, 85, 208, 164, 129, 82,
    82, 199, 166, 17, 200, 73, 169, 46, 94, 246, 156, 214, 57, 35, 5, 197, 106, 32, 180, 21, 164, 182, 195, 152, 156, 78, 194, 124, 176, 12, 232, 201, 98, 250, 166, 218, 17, 136, 198,
    179, 89, 255, 171, 75, 226, 58, 164, 58, 97, 77, 204, 52, 161, 74, 163, 2, 154, 140, 198, 160, 164, 168, 57, 3, 114, 39, 32, 77, 181, 184, 28, 96, 34, 106, 183, 118, 124, 68, 65,
    124, 78, 72, 174, 74, 92, 119, 116, 97, 33, 25, 249, 67, 204, 124, 57, 91, 152, 2, 207, 37, 41, 209, 5, 134, 138, 134, 149, 195, 33, 61, 194, 151, 190, 208, 249, 47, 20, 81, 206,
    62, 195, 97, 130, 129, 87, 166, 210, 180, 69, 165, 55, 117, 87, 92, 73, 115, 56, 105, 210, 7, 37, 101, 167, 66, 33, 157, 203, 113, 83, 159, 166, 115, 64, 1, 120, 223, 144, 132, 3,
    204, 29, 56, 134, 26, 240, 54, 37, 183, 41, 178, 179, 147, 191, 165, 101, 69, 10, 212, 55, 164, 19, 97, 206, 228, 146, 2, 57, 142, 169, 243, 3, 132, 224, 50, 247, 208, 100, 145,
    247, 114, 7, 106, 189, 120, 161, 86, 38, 138, 112, 127, 120, 39, 35, 108, 75, 179, 171, 195, 114, 208, 149, 163, 146, 176, 144, 214, 110, 224, 43, 158, 215, 71, 194, 226, 25, 49,
    222, 44, 79, 67, 24, 80, 82, 60, 197, 105, 71, 55, 238, 211, 34, 85, 92, 206, 144, 102, 41, 124, 127, 181, 64, 34, 10, 148, 41, 192, 128, 3, 86, 20, 201, 129, 171, 173, 20, 73, 24,
    83, 6, 155});

    test_matrix1(0, 0) = Polynomial<int>(256);
    test_matrix1(0, 0).SetCoefficients({2703, 708, 2390, 3037, 1857, 1257, 2030, 1162, 2749, 1476, 3082, 2767, 1047, 2575, 1132, 3044, 854, 1497, 1628, 800, 587, 2509, 1079, 2087, 2286, 3130, 764, 2271, 348, 3269, 2545, 1625, 1537, 2853, 2843, 1198, 2472, 2620, 2331, 2651, 627, 1750, 804, 544, 854, 87, 1946, 799, 3246, 1841, 1412, 619, 1255, 2191, 1576, 2451, 2854, 153, 2880, 2597, 1774, 1432, 854, 1726, 228, 1007, 776, 2427, 2458, 806, 1301, 1015, 366, 1375, 2783, 206, 796, 3194, 1172, 2371, 2743, 219, 2013, 1038, 348, 2350, 904, 1108, 912, 1210, 3237, 1194, 466, 765, 715, 854, 2759, 208, 2786, 931, 671, 3312, 351, 2942, 1314, 246, 626, 1537, 1653, 3038, 2010, 2784, 1071, 3287, 2956, 2857, 989, 161, 1615, 1238, 209, 222, 2383, 3157, 500, 3204, 738, 1963, 515, 1243, 2285, 2409, 710, 1434, 1621, 91, 3048, 1884, 436, 2837, 2334, 2670, 211, 3235, 106, 2405, 3304, 543, 2765, 2526, 2954, 1290, 1587, 1991, 1134, 2696, 684, 885, 774, 1820, 1059, 776, 858, 2636, 3110, 305, 367, 1067, 1998, 3228, 1654, 587, 1737, 561, 697, 1385, 3197, 2335, 3178, 1723, 2484, 2817, 1882, 260, 558, 2016, 3177, 2632, 2809, 2833, 1375, 778, 2025, 2504, 1584, 44, 850, 153, 143, 508, 2472, 1962, 3208, 2590, 1222, 415, 1613, 2211, 751, 2337, 1583, 1707, 2187, 75, 2379, 233, 393, 559, 91, 1220, 2295, 789, 148, 8, 1106, 944, 787, 628, 2678, 588, 2281, 3048, 1551, 1529, 2682, 1534, 3196, 826, 1598, 1653, 71, 2422, 1007, 815, 1681, 1083, 1005, 3110, 460, 3327, 947, 2629, 1882, 2989, 1227, 2749});
    test_matrix1(1, 0) = Polynomial<int>(256);
    test_matrix1(1, 0).SetCoefficients({263, 2982, 88, 1142, 2242, 944, 2384, 1816, 2040, 340, 1829, 1431, 433, 804, 1072, 1863, 548, 321, 2492, 2075, 3077, 1549, 312, 2850, 1516, 26, 1040, 952, 2937, 980, 1721, 3201, 1193, 1091, 1282, 394, 1914, 3254, 2597, 1939, 1575, 2547, 2390, 1910, 2596, 890, 656, 337, 1650, 130, 613, 2814, 733, 2326, 678, 1750, 1629, 494, 2156, 1988, 2327, 899, 2316, 483, 47, 621, 1856, 1859, 2984, 2147, 2297, 3317, 80, 889, 2456, 1855, 2754, 1964, 1889, 1154, 1773, 2231, 1055, 2391, 2996, 3002, 3179, 1573, 353, 2741, 541, 1143, 308, 805, 3081, 2151, 1928, 1723, 542, 898, 255, 306, 3124, 475, 656, 316, 1228, 1634, 2760, 3207, 1935, 112, 3205, 108, 1381, 503, 1012, 64, 461, 2928, 2679, 1754, 856, 2519, 114, 72, 1200, 2586, 16, 363, 1792, 514, 3315, 1171, 1050, 2321, 1327, 1334, 1199, 1041, 188, 209, 2000, 854, 1349, 2703, 2080, 1355, 1334, 2676, 2970, 3255, 1769, 2671, 1009, 2634, 2115, 1639, 137, 452, 2952, 569, 1495, 3183, 1429, 1739, 3216, 1070, 1211, 1446, 274, 2669, 1114, 507, 3079, 0, 20, 877, 887, 2423, 1133, 2049, 3200, 2934, 2415, 319, 119, 587, 1136, 59, 1242, 573, 1233, 1836, 362, 1416, 319, 29, 3061, 342, 2052, 2213, 2133, 1192, 872, 2216, 1113, 2705, 1223, 1769, 529, 1178, 299, 795, 2526, 382, 294, 587, 747, 2561, 596, 1800, 2446, 2903, 1229, 1378, 3196, 2527, 2269, 227, 3016, 1393, 2723, 1348, 2571, 2725, 771, 306, 1084, 1925, 5, 330, 2326, 635, 3224, 2519, 3076, 1096, 3273, 1390, 2209, 1153, 224, 835, 1338, 1301});

  }

  virtual void TearDown() {
    // Clean up the test cases
  }
};

TEST_F(EncDecUnitTest, TestOfEncodeMethod) {
  EncDecUnit enc_unit = EncDecUnit(256);
  Bytes result = enc_unit.encode_(test_polynomial1, 12);
  std::string expected_result = "41aa8db87c81f5250106318beddb923006d0976ab5f08776b3104580b1c8d980b5ae2560c2132831e09b1f2b20f1ec7664f62e5e396b307b515ea6b4caf443c5444dff07395c1841ef911b18b9cae269c65b05068d2a0b6b5c5907516522933097462ed4e22bafc269229c0a16d3649a423f7b6c2662497b90d2ad4a653dae11897da72a1e72196d03a6eb34c374943e90a8bf894cccd3a73cbf54a30261b2d3322a8127a301334d111a3cdb82080ce038e7162e882221366cae53bb11f073210da28727bc32b2252008f3331c208e04f39c6743972e2bc9ebc65874fb00c01a12d28b9a60b69e45663bf8d1c2c169ac80342615db322c2781563ba958700a56d92d2a9ac33ed5b5429478f39378a0db413a68738eb7aaea30ad60a50a0b02bc1309a7eac4199ce08aaea261e7f1246260b495567dd5d34302409ce3292668e59a018a774b5c766b51cd019a93cc45a27be20966bb6ed0aba5d5198115026edcf1b5192443510311f8c00cf1ac7d0132797ba68b0eb40fed5b412ec9b40b2408";
  EXPECT_EQ(result.FromBytesToHex(), expected_result);
}

TEST_F(EncDecUnitTest, TestOfDecodeMethod) {
  EncDecUnit enc_unit = EncDecUnit(256);
  Polynomial<int> result = enc_unit.decode_(test_bytes1, 12);
  Polynomial<int> expected_result = Polynomial<int>(256);
  expected_result.SetCoefficients({{1340, 2153, 2577, 3258, 1855, 570, 312, 3, 689, 951, 645, 211, 2689, 125, 3175, 152, 3306, 151, 32, 1280, 1712, 
    1708, 1717, 1466, 1740, 859, 1516, 1180, 372, 2872, 72, 2858, 2376, 1903, 1833, 1726, 2471, 1806, 1291, 3272, 931, 3035, 413, 2182, 2321, 477, 2666,
    1111, 55, 2543, 893, 1163, 871, 961, 2767, 291, 2806, 1206, 2985, 110, 3119, 2328, 739, 1196, 273, 681, 2007, 1503, 714, 321, 1556, 1546, 754, 1786,
    1498, 747, 1518, 2598, 2210, 445, 2679, 185, 1936, 2035, 3257, 438, 1705, 1820, 2389, 975, 3115, 3301, 2451, 31, 2239, 2684, 2703, 2286, 1925, 812,
    742, 265, 2882, 1739, 2842, 3207, 1537, 1089, 1297, 709, 2377, 1429, 967, 1578, 2435, 1661, 318, 956, 1011, 1988, 1574, 2513, 36, 2057, 2522, 2095,
    2172, 2320, 3307, 1531, 1728, 3083, 2292, 1892, 1037, 990, 3164, 1291, 295, 1329, 2701, 2256, 2959, 2069, 2848, 1993, 1334, 1515, 3096, 1973, 1601, 
    978, 2616, 2402, 441, 342, 1236, 1314, 316, 2719, 2247, 153, 597, 133, 1778, 2962, 2189, 1014, 260, 1390, 1606, 1479, 3132, 2253, 3296, 2950, 412, 
    2078, 2069, 2596, 1696, 2286, 2836, 252, 2075, 2059, 2362, 2191, 1154, 3171, 3277, 741, 583, 2901, 43, 2843, 2066, 2253, 2906, 2615, 1847, 1583, 1383, 
    332, 1153, 2798, 713, 2083, 52, 3030, 1239, 2076, 2295, 136, 1530, 1556, 3238, 2245, 1153, 1733, 2103, 2567, 127, 1307, 1261, 1371, 368, 816, 143, 635, 
    1810, 2559, 1050, 1265, 1866, 154, 1513, 1835, 1990, 1867, 2034, 577, 1937, 458, 2700, 392, 439, 3079, 1352, 506, 695, 2627, 2137, 196, 2577, 1987}});
  EXPECT_EQ(result.GetCoefficients(), expected_result.GetCoefficients());
}


TEST_F(EncDecUnitTest, TestOfDecodeMatrixMethod) {
  EncDecUnit enc_unit = EncDecUnit(256);
  Matrix<Polynomial<int>> result = enc_unit.DecodeBytesToMatrix(test_bytes2, 1, 2, 12);
  Matrix<Polynomial<int>> expected_result = Matrix<Polynomial<int>>(1, 2, 256);
  expected_result(0, 0) = Polynomial<int>(256);
  expected_result(0,0).SetCoefficients({1973, 315, 2097, 1192, 2805, 2091, 2554, 2335, 1500, 911, 3111, 2959, 1663, 3119, 3004, 649, 2697, 426, 2258, 2485, 1320, 1326,
  1254, 2929, 2655, 2786, 1186, 1065, 1552, 617, 1312, 1011, 1416, 979, 766, 1279, 209, 2871, 1870, 688, 1635, 3081, 2707, 1726, 2808, 1327, 1638, 1839, 3099, 2816, 2504,
  2017, 1853, 3159, 3213, 3281, 1293, 725, 97, 2074, 2924, 1650, 1137, 496, 549, 2676, 940, 110, 211, 822, 2558, 3017, 1048, 2740, 2243, 2962, 1888, 1963, 2226, 1303, 2987,
  2476, 703, 2595, 760, 887, 3301, 454, 2856, 1706, 2964, 1441, 2025, 1291, 2263, 2018, 2954, 1863, 2749, 2394, 3251, 983, 1388, 2585, 1615, 176, 2072, 2938, 3229, 1520, 793,
  561, 1547, 1926, 2317, 2149, 3240, 543, 3181, 2439, 2619, 504, 1652, 640, 1310, 1134, 1399, 1703, 908, 1630, 479, 1988, 2891, 3327, 1293, 3191, 212, 1248, 2276, 1812, 3138,
  3182, 850, 1140, 384, 3318, 1605, 2063, 2814, 1436, 2331, 2826, 527, 238, 437, 1823, 2070, 634, 1340, 2870, 2148, 760, 102, 183, 2110, 762, 2996, 3011, 514, 886, 1565, 996,
  417, 1930, 2451, 1822, 189, 2009, 942, 527, 2307, 2885, 1700, 1984, 2639, 1232, 3177, 3102, 748, 2705, 1650, 2271, 2154, 2626, 2529, 1128, 2863, 3058, 3290, 1336, 2685, 2433,
  2653, 219, 1871, 2848, 153, 458, 3112, 99, 2541, 1019, 859, 1103, 1744, 2501, 2402, 833, 1463, 1777, 1877, 339, 2438, 680, 3263, 101, 2591, 2035, 2765, 1551, 415, 3157, 1256,
  764, 965, 1724, 1692, 2137, 1895, 1992, 490, 2019, 1124, 924, 909, 3159, 2826, 1890, 977, 2979, 1423, 1476, 3277, 673, 1278, 1909});
  expected_result(0, 1) = Polynomial<int>(256);
  expected_result(0,1).SetCoefficients({1435, 2915, 2402, 2325, 3145, 1248, 2423, 514, 1437, 1447, 2857, 1642, 379, 1708, 3091, 1089, 32, 1864, 2844, 808, 1914, 1681, 380, 236,
  359, 2854, 2195, 1330, 1480, 1372, 2037, 3086, 2256, 94, 3176, 139, 558, 763, 633, 1186, 1505, 3202, 3073, 2748, 1043, 2427, 1401, 150, 509, 2693, 2792, 632, 1577, 2611, 2818,
  1673, 1721, 1060, 1839, 533, 867, 1707, 1941, 3122, 606, 1460, 1085, 1101, 1622, 587, 1602, 3282, 1458, 603, 3225, 2125, 1286, 1869, 3107, 2550, 1839, 1632, 601, 2760, 978, 2623,
  2626, 1361, 1232, 2074, 594, 3189, 422, 3201, 2377, 746, 1630, 2511, 2518, 563, 1285, 1708, 1056, 347, 1700, 3131, 3224, 1257, 3266, 2823, 2060, 3230, 2658, 2671, 474, 2177, 966,
  1435, 3071, 1210, 2786, 2627, 314, 1238, 1228, 2579, 842, 42, 3226, 3176, 1184, 2698, 825, 1824, 39, 1234, 2229, 459, 608, 1698, 1719, 1991, 324, 1988, 2126, 2788, 3146, 1909, 372,
  534, 2329, 1087, 3276, 919, 2139, 41, 1487, 658, 1489, 2144, 1674, 2392, 451, 978, 1986, 3049, 2512, 767, 276, 3301, 830, 1564, 386, 1400, 678, 2893, 1349, 890, 1909, 1477, 841, 903,
  617, 125, 1317, 2678, 322, 2514, 459, 1335, 1695, 1850, 320, 1920, 223, 2121, 3075, 476, 1592, 424, 1776, 595, 2487, 2850, 947, 3065, 1445, 1110, 1034, 893, 932, 1553, 1230, 2350,
  2306, 2275, 937, 63, 132, 814, 247, 1613, 1937, 1839, 2567, 3030, 376, 1386, 2598, 1800, 2175, 631, 3107, 1206, 2995, 3130, 114, 2397, 675, 2825, 1680, 1773, 3040, 2530, 2007, 3108,
  2530, 785, 3294, 1266, 2115, 1281, 3154, 3155, 1897, 884});
  EXPECT_EQ(result(0, 0), expected_result(0, 0));
  EXPECT_EQ(result(0, 1), expected_result(0, 1));
}

TEST_F(EncDecUnitTest, TestOfEncodeMatrixMethod) {
  EncDecUnit enc_unit = EncDecUnit(256);
  Bytes result = enc_unit.EncodeMatrixToBytes(test_matrix1, 12);
  std::string expected_bytes = "8f4a2c56d9bd41974eeea748bd4a5c0afcac17f4a06c44be56935d5c06324bd29c377482eea8c3fcf28d5c51ccf199650156b21beb4aa8c9a31bb9a573626d2403225673059af731ae1c7384b526e7f488283699269b09405ba2ee865956e36be4f03e08b3979a693215753f6ef155dfea0c1ca3c7943494b7ba0ddde7405ce19288434590a34ba5ac4ad2d12fcb6235c70a0de23a3a9f02cf5fe1b722650f72126075e6bdda07ae2f74cd8c9bb2dd130a4f664dd1e00d4f59c5f441c8e2b27a03b24ded9896c6a25955b605e8cb75b451b11ee9a6d330ca6a5096e8fc21cdea9d8aab5033767c6e84a8ac523706c3712384305ac3a4261c136fb142cec7c976b624c91623b992567dfc916abc6bb419b05a47102e027e698ca4f91ab15fa530e9879c30c6025293098fc01fa8a97a88eca1c6f4194d368aef12922fb66a8bb8044b990e89f1225b404cf7583194800052043b13432776ca24e988be0f965f7aea5f7cac333e5667476097eff33291b643ed63c2ccf1cfb353a45ad7bacbd4ab0761ba586047c2083b508971f84715257759b14132307474241214bcb98105dc603821b2eca50110843b794b3db916c8a9344402a5187a67cb253a7927369f56697724aa3790121572260865e2afdd6291a6626d5de61e6c487c1739380c391e2fd026403774a83b86f958cf50903798f973c2ca7a612748ed768b1f7495b4abbb6b5c626151ab1d7247345132097c8688b76b1e2238ff201334bc1d90c213cc2466c87ac88f070785cc0665751ff40304cd01b777aa6d58739d728004b0a4a110b016002720f33c491a14912f6553af1441bc100dd0673545f5a820b8543645a79a7bcbe9f6a6f1a3a443786689401c889b23d7f5c695b56c90ec42bb645a12d1a65ab41f070c0014d0367773976d1480806cb76ff91377b02470b403dad423d1c4726a81583fd101f56b1504588a55884a68838a5914a9c7946e11a2492bb131dee91726b124eb12a05482708e79b5cd24567cfc9ddd380ec81b57a34a540b5aaa0323133c547805a01416b927987c9d048c44c9ec56a11848e030343a5551";
  EXPECT_EQ(result.FromBytesToHex(), expected_bytes);
  


}
